---
description: 快速安全审计，专注于检查常见安全漏洞（OWASP Top 10）
---

# 安全漏洞快速检查

对指定代码进行快速安全审计，重点检查 OWASP Top 10 安全问题：

## 检查项目

### 🔴 1. 注入攻击
- **SQL 注入**：检查是否使用字符串拼接 SQL（应该用 MyBatis-Plus 参数化查询）
- **NoSQL 注入**：检查 MongoDB、Redis 查询是否安全
- **命令注入**：检查是否直接执行用户输入的系统命令

### 🔴 2. 身份认证失效
- Token 验证是否正确
- 密码是否加密存储（BCrypt）
- 会话管理是否安全
- 是否存在硬编码的密码/密钥

### 🔴 3. 敏感数据泄露
- 日志中是否打印敏感信息（密码、Token、身份证号等）
- API 响应是否暴露过多信息
- 错误信息是否泄露系统细节

### 🔴 4. XML 外部实体攻击 (XXE)
- XML 解析器配置是否安全

### 🔴 5. 访问控制失效
- 是否缺少权限验证（@PreAuthorize）
- 是否存在越权访问风险
- 业务线隔离是否正确实现

### 🔴 6. 安全配置错误
- CORS 配置是否过于宽松
- 默认账号密码是否修改
- 调试信息是否在生产环境关闭

### 🔴 7. 跨站脚本攻击 (XSS)
- 用户输入是否转义
- Vue 中是否使用 v-html 注入未过滤内容
- API 响应 Content-Type 是否正确

### 🔴 8. 不安全的反序列化
- 是否使用不安全的反序列化方法
- Jackson 配置是否安全

### 🔴 9. 使用含有已知漏洞的组件
- 依赖库版本是否过旧
- 是否存在已知 CVE 漏洞

### 🔴 10. 不足的日志记录和监控
- 关键操作是否记录日志
- 是否包含 traceId 用于追踪

## 输出格式

### 🚨 严重安全漏洞
列出发现的严重安全问题，必须立即修复

### ⚠️ 潜在安全风险
列出可能存在的安全风险

### ✅ 安全检查通过项
列出符合安全规范的部分

### 🔧 修复建议
针对每个问题提供具体的修复代码示例

---

**使用方法**：
```
/security-check path/to/file
/security-check  # 检查当前变更
```
